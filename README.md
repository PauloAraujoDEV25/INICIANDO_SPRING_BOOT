# üéÆ Pok√©mon Cache API

API REST para gerenciamento e cache de dados de Pok√©mon, integrada com a PokeAPI oficial.

---

## üìã √çndice

- [Sobre o Projeto](#-sobre-o-projeto)
- [Tecnologias](#-tecnologias)
- [Funcionalidades](#-funcionalidades)
- [Instala√ß√£o](#-instala√ß√£o)
- [Configura√ß√£o](#Ô∏è-configura√ß√£o)
- [Uso da API](#-uso-da-api)
- [Endpoints](#-endpoints)
- [Exemplos de Requisi√ß√µes](#-exemplos-de-requisi√ß√µes)
- [Modelo de Dados](#-modelo-de-dados)
- [Tratamento de Erros](#Ô∏è-tratamento-de-erros)
- [Testes](#-testes)
- [Deploy](#-deploy)
- [Contato](#-contato)
- [Contribuindo](#-contribuindo)

---

## üéØ Sobre o Projeto

Esta API permite **cachear informa√ß√µes de Pok√©mon** da PokeAPI oficial em um banco de dados local (H2), possibilitando buscas mais r√°pidas, adi√ß√£o de notas pessoais e marca√ß√£o de favoritos. √â ideal para aplica√ß√µes que necessitam de consultas frequentes a dados de Pok√©mon sem sobrecarregar a API oficial.

**Diferenciais:**
- ‚úÖ Cache inteligente com persist√™ncia local
- ‚úÖ Sistema de favoritos com anota√ß√µes
- ‚úÖ Busca r√°pida por tipo
- ‚úÖ Tratamento robusto de erros
- ‚úÖ Documenta√ß√£o completa de robustez

---

## üöÄ Tecnologias

- **Java 21** (LTS)
- **Spring Boot 3.2.0**
- **Spring Data JPA**
- **H2 Database** (em mem√≥ria)
- **Spring WebFlux** (WebClient)
- **Lombok**
- **Gradle 8.5**
- **Spring Boot Actuator**

---

## ‚ú® Funcionalidades

‚úÖ Cache de Pok√©mon da PokeAPI  
‚úÖ Busca por ID local ou nome na API  
‚úÖ Listagem paginada  
‚úÖ Filtro por tipo (fire, water, electric, etc.)  
‚úÖ Sistema de favoritos  
‚úÖ Anota√ß√µes personalizadas (at√© 1000 caracteres)  
‚úÖ Valida√ß√µes de entrada robustas  
‚úÖ Logs estruturados (INFO, WARN, ERROR, DEBUG)  
‚úÖ Timeout configurado (5s) para API externa  
‚úÖ Health checks com Spring Actuator  

---

## üì¶ Instala√ß√£o

### Pr√©-requisitos

- Java 21 ou superior
- Gradle (wrapper inclu√≠do no projeto)

### Passos

1. **Clone o reposit√≥rio:**

```bash
git clone https://github.com/PauloAraujoDEV25/INICIANDO_SPRING_BOOT.git
cd INICIANDO_SPRING_BOOT
```

2. **Compile o projeto:**

```bash
# Windows
.\gradlew.bat build

# Linux/Mac
./gradlew build
```

3. **Execute a aplica√ß√£o:**

```bash
# Windows
.\gradlew.bat bootRun

# Linux/Mac
./gradlew bootRun
```

4. **Acesse a aplica√ß√£o:**

A API estar√° dispon√≠vel em **http://localhost:8080**

---

## ‚öôÔ∏è Configura√ß√£o

### Arquivo `application.properties`

```properties
# Aplica√ß√£o
spring.application.name=pokemon-cache-api
server.port=8080

# Banco de Dados H2
spring.datasource.url=jdbc:h2:mem:pokemondb
spring.datasource.username=sa
spring.datasource.password=

# JPA
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# Console H2
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# PokeAPI
pokeapi.base-url=https://pokeapi.co/api/v2

# Logging
logging.level.br.com.pokemon=INFO
```

### Console H2

Para visualizar os dados no banco:

1. Acesse: **http://localhost:8080/h2-console**
2. Configure a conex√£o:
   - **JDBC URL:** `jdbc:h2:mem:pokemondb`
   - **User Name:** `sa`
   - **Password:** *(deixe vazio)*
3. Clique em **"Connect"**

**Queries √∫teis:**

```sql
-- Listar todos os Pok√©mon
SELECT * FROM POKEMON;

-- Buscar favoritos
SELECT * FROM POKEMON WHERE FAVORITE = TRUE;

-- Contar por tipo
SELECT TYPES, COUNT(*) FROM POKEMON GROUP BY TYPES;

-- √öltimos cacheados
SELECT * FROM POKEMON ORDER BY CACHED_AT DESC LIMIT 10;
```

---

## üìñ Uso da API

### Documenta√ß√£o Swagger (Planejado)

Em breve a documenta√ß√£o interativa estar√° dispon√≠vel em:
- Desenvolvimento: http://localhost:8080/swagger-ui.html

---

## üîå Endpoints

Base URL: **`http://localhost:8080`**

### 1. Cachear Pok√©mon

Busca um Pok√©mon na PokeAPI e salva no banco local.

**Request:**
```http
POST /api/pokemon/cache/{nameOrId}
```

**Par√¢metros:**
- `nameOrId` (path): Nome ou ID do Pok√©mon (ex: `"pikachu"` ou `"25"`)

**Respostas:**
- `201 Created`: Pok√©mon cacheado com sucesso
- `404 Not Found`: Pok√©mon n√£o encontrado na PokeAPI
- `502 Bad Gateway`: Erro na integra√ß√£o com PokeAPI

---

### 2. Listar Todos os Pok√©mon

Retorna lista paginada de Pok√©mon cacheados.

**Request:**
```http
GET /api/pokemon?page=0&size=20
```

**Par√¢metros de Query:**
- `page` (opcional): N√∫mero da p√°gina (padr√£o: `0`)
- `size` (opcional): Tamanho da p√°gina (padr√£o: `10`)

**Resposta:**
- `200 OK`: Lista paginada com dados

---

### 3. Buscar Pok√©mon por ID Local

Retorna um Pok√©mon espec√≠fico pelo ID do banco local.

**Request:**
```http
GET /api/pokemon/{id}
```

**Par√¢metros:**
- `id` (path): ID local do Pok√©mon no banco

**Respostas:**
- `200 OK`: Pok√©mon encontrado
- `404 Not Found`: Pok√©mon n√£o encontrado

---

### 4. Buscar por Tipo

Busca Pok√©mon por tipo com pagina√ß√£o.

**Request:**
```http
GET /api/pokemon/search?type=fire&page=0&size=20
```

**Par√¢metros de Query:**
- `type` (obrigat√≥rio): Tipo do Pok√©mon (ex: `"fire"`, `"water"`, `"electric"`)
- `page` (opcional): N√∫mero da p√°gina (padr√£o: `0`)
- `size` (opcional): Tamanho da p√°gina (padr√£o: `10`)

**Respostas:**
- `200 OK`: Busca realizada com sucesso
- `400 Bad Request`: Tipo inv√°lido ou vazio

---

### 5. Favoritar/Desfavoritar Pok√©mon

Marca ou desmarca um Pok√©mon como favorito e adiciona nota.

**Request:**
```http
PATCH /api/pokemon/{id}/favorite
Content-Type: application/json
```

**Par√¢metros:**
- `id` (path): ID local do Pok√©mon

**Body:**
```json
{
  "favorite": true,
  "note": "Meu Pok√©mon favorito!"
}
```

**Respostas:**
- `200 OK`: Pok√©mon atualizado com sucesso
- `404 Not Found`: Pok√©mon n√£o encontrado
- `400 Bad Request`: Nota excede 1000 caracteres

---

### 6. Health Check

Verifica o status da aplica√ß√£o.

**Request:**
```http
GET /actuator/health
```

**Resposta:**
- `200 OK`: Aplica√ß√£o funcionando corretamente

---

## üíª Exemplos de Requisi√ß√µes

### Cachear Pikachu

```bash
# Windows PowerShell
Invoke-RestMethod -Method POST -Uri http://localhost:8080/api/pokemon/cache/pikachu

# Linux/Mac
curl -X POST http://localhost:8080/api/pokemon/cache/pikachu
```

---

### Listar Pok√©mon (primeira p√°gina)

```bash
# Windows PowerShell
Invoke-RestMethod -Uri "http://localhost:8080/api/pokemon?page=0&size=10"

# Linux/Mac
curl -X GET "http://localhost:8080/api/pokemon?page=0&size=10"
```

---

### Buscar Pok√©mon do tipo fogo

```bash
# Windows PowerShell
Invoke-RestMethod -Uri "http://localhost:8080/api/pokemon/search?type=fire&page=0&size=20"

# Linux/Mac
curl -X GET "http://localhost:8080/api/pokemon/search?type=fire&page=0&size=20"
```

---

### Marcar como favorito

```bash
# Windows PowerShell
$body = @{favorite=$true; note="Muito forte em batalhas!"} | ConvertTo-Json
Invoke-RestMethod -Method PATCH -Uri http://localhost:8080/api/pokemon/1/favorite -Body $body -ContentType "application/json"

# Linux/Mac
curl -X PATCH http://localhost:8080/api/pokemon/1/favorite \
  -H "Content-Type: application/json" \
  -d '{
    "favorite": true,
    "note": "Muito forte em batalhas!"
  }'
```

---

### Teste Completo

Execute em sequ√™ncia para validar todas as funcionalidades:

```bash
# 1. Cachear Pok√©mon
Invoke-RestMethod -Method POST -Uri http://localhost:8080/api/pokemon/cache/pikachu
Invoke-RestMethod -Method POST -Uri http://localhost:8080/api/pokemon/cache/charizard
Invoke-RestMethod -Method POST -Uri http://localhost:8080/api/pokemon/cache/bulbasaur
Invoke-RestMethod -Method POST -Uri http://localhost:8080/api/pokemon/cache/squirtle

# 2. Listar todos
Invoke-RestMethod -Uri http://localhost:8080/api/pokemon

# 3. Buscar por tipo
Invoke-RestMethod -Uri "http://localhost:8080/api/pokemon/search?type=fire"

# 4. Ver detalhes
Invoke-RestMethod -Uri http://localhost:8080/api/pokemon/1

# 5. Marcar como favorito
$body = @{favorite=$true; note="Primeiro capturado!"} | ConvertTo-Json
Invoke-RestMethod -Method PATCH -Uri http://localhost:8080/api/pokemon/1/favorite -Body $body -ContentType "application/json"

# 6. Verificar no H2 Console
# Acesse: http://localhost:8080/h2-console
# Execute: SELECT * FROM POKEMON WHERE FAVORITE = TRUE;
```

---

## üìä Modelo de Dados

### PokemonResponse

```json
{
  "id": 1,
  "idPokeApi": 25,
  "name": "pikachu",
  "height": 4,
  "weight": 60,
  "ability": "static",
  "types": "electric",
  "cachedAt": "2025-10-27T15:30:00",
  "favorite": true,
  "note": "Meu Pok√©mon favorito!"
}
```

### PagePokemonSummary

```json
{
  "content": [
    {
      "id": 1,
      "idPokeApi": 25,
      "name": "pikachu",
      "types": "electric",
      "cachedAt": "2025-10-27T15:30:00"
    }
  ],
  "pageable": {
    "pageNumber": 0,
    "pageSize": 10
  },
  "totalPages": 5,
  "totalElements": 50,
  "first": true,
  "last": false
}
```

### Estrutura da Entidade `Pokemon`

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `id` | BIGINT | ID local (PK, auto-incremento) |
| `idPokeApi` | INTEGER | ID do Pok√©mon na PokeAPI (√∫nico) |
| `name` | VARCHAR(255) | Nome do Pok√©mon |
| `height` | INTEGER | Altura (dec√≠metros) |
| `weight` | INTEGER | Peso (hectogramas) |
| `ability` | VARCHAR(255) | Primeira habilidade |
| `types` | VARCHAR(500) | Tipos (CSV: "fire, flying") |
| `cachedAt` | TIMESTAMP | Data/hora do cache |
| `favorite` | BOOLEAN | Marcado como favorito? |
| `note` | VARCHAR(1000) | Anota√ß√£o pessoal |

---

## ‚ö†Ô∏è Tratamento de Erros

A API utiliza c√≥digos HTTP padr√£o e retorna respostas JSON padronizadas:

### C√≥digos HTTP

| C√≥digo | Significado | Quando ocorre |
|--------|-------------|---------------|
| `200 OK` | Sucesso | GET bem-sucedido |
| `201 Created` | Criado | POST bem-sucedido |
| `400 Bad Request` | Requisi√ß√£o inv√°lida | Par√¢metros inv√°lidos, valida√ß√£o falhou |
| `404 Not Found` | N√£o encontrado | Pok√©mon n√£o existe |
| `502 Bad Gateway` | Erro na API externa | PokeAPI indispon√≠vel ou erro |
| `500 Internal Server Error` | Erro interno | Erro inesperado no servidor |

### Exemplo de Resposta de Erro

```json
{
  "timestamp": "2025-10-27T15:30:00",
  "status": 404,
  "error": "Not Found",
  "message": "Pok√©mon 'pokemoninexistente' n√£o encontrado na PokeAPI",
  "path": "/api/pokemon/cache/pokemoninexistente"
}
```

### Valida√ß√µes Implementadas

- ‚úÖ IDs devem ser >= 1
- ‚úÖ Pagina√ß√£o: `page` >= 0, `size` >= 1
- ‚úÖ Tipo n√£o pode ser vazio
- ‚úÖ Nota m√°ximo 1000 caracteres
- ‚úÖ Timeout de 5 segundos na API externa

### Documenta√ß√£o Completa de Robustez

üìÑ Para informa√ß√µes t√©cnicas detalhadas sobre tratamento de erros, exce√ß√µes customizadas, logs estruturados e testes de valida√ß√£o, consulte: **[ROBUSTEZ.md](ROBUSTEZ.md)**

---

## üìù Boas Pr√°ticas

- ‚úÖ Cache Pok√©mon antes de realizar opera√ß√µes repetidas
- ‚úÖ Use pagina√ß√£o para listas grandes
- ‚úÖ Valide dados antes de enviar requisi√ß√µes
- ‚úÖ Trate erros de conex√£o com a PokeAPI
- ‚úÖ Monitore logs para debugging
- ‚úÖ Use o Console H2 para inspe√ß√£o de dados

---

## üß™ Testes

Execute os testes unit√°rios com:

```bash
# Windows
.\gradlew.bat test

# Linux/Mac
./gradlew test
```

Para relat√≥rio de cobertura (futura implementa√ß√£o com JaCoCo):

```bash
.\gradlew.bat test jacocoTestReport
```

---

## üöÄ Deploy

### Docker (Planejado)

```dockerfile
FROM openjdk:21-jdk-slim
COPY build/libs/*.jar app.jar
ENTRYPOINT ["java","-jar","/app.jar"]
```

**Build e execute:**

```bash
docker build -t pokemon-cache-api .
docker run -p 8080:8080 pokemon-cache-api
```

### Executar JAR diretamente

```bash
# Build
.\gradlew.bat build

# Execute
java -jar build/libs/pokemon-cache-api-1.0.0.jar
```

---

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

## üë§ Contato

**Paulo Henrique Araujo**

- GitHub: [@PauloAraujoDEV25](https://github.com/PauloAraujoDEV25)
- Email: (adicione seu email)

---

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Sinta-se √† vontade para:

1. Fazer fork do projeto
2. Criar uma branch para sua feature (`git checkout -b feature/MinhaFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Adiciona MinhaFeature'`)
4. Push para a branch (`git push origin feature/MinhaFeature`)
5. Abrir um Pull Request

---

## üìå Roadmap

- [ ] Autentica√ß√£o JWT
- [ ] Swagger/OpenAPI documenta√ß√£o
- [ ] Cache Redis
- [ ] Busca avan√ßada (nome, habilidades, stats)
- [ ] Export de dados (CSV, JSON)
- [ ] Sistema de tags personalizadas
- [ ] Compara√ß√£o entre Pok√©mon
- [ ] Testes de integra√ß√£o
- [ ] CI/CD com GitHub Actions
- [ ] Deploy em cloud (Azure/AWS)

---

## üîó Links √öteis

| Recurso | URL |
|---------|-----|
| **API Base** | http://localhost:8080 |
| **Console H2** | http://localhost:8080/h2-console |
| **Health Check** | http://localhost:8080/actuator/health |
| **PokeAPI Docs** | https://pokeapi.co/docs/v2 |

---

<div align="center">

### ‚≠ê Desenvolvido com ‚òï Java 21 e üíö Spring Boot por Paulo Henrique Araujo

**Se este projeto foi √∫til, deixe uma ‚≠ê no reposit√≥rio!**

[‚¨Ü Voltar ao topo](#-pok√©mon-cache-api)

</div>
